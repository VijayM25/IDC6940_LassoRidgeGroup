---
title: "Lasso - Ridge Regression Group for data science projects - Fall 2025"
subtitle: "A report on Lasso-Ridge Regression"
author: "Vijay Mohanam, Jennifer Nesbit and Sassou Khabou (Advisor: Dr. Cohen)"
date: '`r Sys.setenv(TZ = "America/New_York") format(Sys.Date(), "%Y-%m-%d")`'
format:
  html:
    code-fold: true
course: Capstone Projects in Data Science
bibliography: references.bib # file contains bibtex for references
#always_allow_html: true # this allows to get PDF with HTML features
self-contained: true
execute: 
  warning: false
  message: false
editor: 
  markdown: 
    wrap: 72
---

Slides: [slides.html](slides.html){target="_blank"} ( Go to `slides.qmd`
to edit)

::: callout-note
**Week 01:** This is our first week as group, we are trying to compile a summary of introductions!

**Week 02:** We tried to add more articles from our research and narrowing on a particular dataset!

**Week 03:** Downloaded USA cancer dataset, exploring attributes and records for our study!

**Week 04:** Analysed the variables, selected and recoded for our model!

**Week 05:** Refined the variables, as metadata and data were not matching!

Nice effort!
:::

## Introduction

Least Absolute Shrinkage and Selection Operator (Lasso) and Ridge regression are both regularization techniques used to prevent overfitting and multicollinearity in linear regression models by adding a penalty term to the loss function. The Lasso regression method was first introduced by Tibshirani in 1996 and has become a widely used method in both statistical modeling and machine learning. Lasso regression uses L1 regularization, which adds a penalty proportional to the sum of the absolute values of the coefficients, whereas Ridge uses L2 regularization, which adds a penalty proportional to the sum of the squared coefficients. An additional regularization technique called Elastic Net regression, combines both Lasso and Ridge. This technique is useful when there are many correlated features. The L1 penalty used with Lasso shrinks some coefficients to zero which allows for automated selection while also reducing model complexity. Overall Lasso is able to combine both predictive accuracy with interpretability. 

Lasso has demonstrated its versatile and practical uses as it has been applied across diverse applications. In healthcare, Lasso has been used to predict prevalence of child malaria Aheto et al., 2021[@aheto], stroke risk in hypertensive patients Huang & Liu, 2025[@huang] and adverse drug reactions in polypharmacy Sommer et al., 2024 [@sommer]. These studies all highlight the ability for Lasso to produce models with fewer predictors while maintaining strong performance and often outperforming Ridge regression models in interpretability. Lasso has also been applied to clinical diagnostics, specifically improving disease classification for glaucoma progression Fujino et al., 2015 [@fujino] and differentiating between hematologic cancers Amaador et al., 2022[@amaador]. Another medical related paper on gastroenterology (Ali, H et al., 2023)[@ali] also applied Lasso to select key predictors and remove insignificant predictors by setting their coefficients to zero. These applications demonstrate the ability of Lasso to enhance decision making with streamlined models.

Lasso regression has also been proven as an effective methodology in economics and finance. Specifically, in predicting corporate bankruptcy Pereira et al., 2016[@pereira] and analyzing housing price network connectedness Gabauer et al., 2024[@gabauer]. Lasso has also been used for technology applications such as supporting innovations specifically with sensor selection for wearable respiratory monitoring devices Laufer et al., 2023 [@laufer] and improved interpretability with decision tree models Czajkowski et al., 2023 [@czajkowski].

Research has been done to compare the use of Lasso as a methodology to multiple related techniques such as Ridge and Elastic Net. Studies have shown that Ridge regression sometimes outperforms Lasso when predictor variables are highly correlated. However, Lasso tends to be more valuable when only a few predictors are significant and applicable to the problem at hand Vidaurre et al., 2013[@vidaurre]. Overall, Lasso shows a consistent advantage with its ability to produce sparse, interpretable and efficient models making it an excellent tool for both modeling and research.

A principal advantage of Lasso (Least Absolute Shrinkage and Selection Operator) regression is its capacity for feature shrinkage and selection. As established in the seminal works by “Introduction to the Lasso” (Gauraha, N, 2018)[@gauraha], selection of most relevant variables from a large set of clinical and pathological data while shrinking less important ones to zero(Li, Y., Bai. 2023)[@li] and “Regression Shrinkage and Selection Via the Lasso” (Robert Tibshirani. 1996)[@robert]. They also compare lasso regression to both ridge regression and subset selection. Unlike in ridge regression, where all parameters can only asymptotically approach zero, lasso regression allows some parameters to reach zero. These techniques are applied in Machine Learning for feature selection techniques in predictive modeling (R. Muthukrishnan and R. Rohini. 2016)[@muthu] .On the same lines, we can see how to handle zero inflated predictors(Mariella Gregorich et al., 2025)[@mari] handled by Lasso.

After considering the multiple impactful applications of Lasso regression, this study will apply Lasso to a real-world healthcare problem using the Surveillance, Epidemiology and End Results (SEER) database. Specifically, we aim to develop predictive models that will estimate the likelihood of various cancer treatments such as chemotherapy, radiation therapy or surgery based on patient demographics and clinical characteristics. We will leverage the ability of Lasso to select the most influential factors driving treatment decisions while automatically excluding less informative predictors. The ultimate goal of this application is to support utilization management processes by streamlining treatment approval pathways and expediting patient access to appropriate care. Through this study, we aim to demonstrate how Lasso regressive can serve as an effective tool for improving operational efficiency and decision making in oncology care.

*The final introduction paragraph on the problem that we will apply Lasso to will be added to draft next week after finalizing the problem and choosing a dataset.*

## Data Exploration and Visualization




The data for this study was obtained from the SEER program of the [National Cancer Institute (NCI)](https://seer.cancer.gov/archive/manuals/2018/SPCSM_2018_maindoc.pdf). SEER is a comprehensive population-based cancer registry within the United States that consists of a collection of detailed information on cancer incidence, patient demographics, tumor characteristics, treatment modalities and survival outcomes. The SEER dataset provides high quality, standardized data that allows for large-scale analyses of cancer patterns, treatments and outcomes across diverse populations in the United States. For this study we focused on female breast cancer cases (ICD O-3 site codes C50.0 - C50.9) from 2018 - 2021 and specific variables to indicate whether a patient received specific treatment such as surgery, radiation, chemotherapy, immunotherapy or hormone therapy based on the SEER treatment summary fields. This time period aligns with the period following SEER’s transition to the Extent of Disease (EOD) 2018 and Summary Stage 2018 systems. This time was chosen because these years provide the most consistent and comprehensive recording of tumor stage, biological markers and treatment variables. Using 2018 - 2021 ensures compatibility across staging and treatment codes while avoiding inconsistencies in earlier datasets.

We focused on variables that are clinically relevant and have been shown to influence treatment decisions in breast cancer. These variables have been categorized into three groups: treatment variables, tumor characteristics and patient demographics. Surgical treatment was identified using the variable **RX Sum–Surg Prim Site**, radiation therapy from **Phase I, II and III Radiation Treatment Modality**, chemotherapy from **RX Summ–Chemo**, hormone therapy from **RX Summ–Hormone** and immunotherapy from **RX Summ–BRM**. These variables capture first-course treatments administered after diagnosis. Only first primary malignancies were included to avoid confounding from prior cancer diagnoses and treatments **(Sequence number = 00, 01)**. Patients with missing or unknown treatment or key staging information were excluded. Each treatment variable was recoded into a binary outcome with 1 indicating that treatment was received and 0 indicating that treatment was not received. 


Table 1

***Treatment Variables***

|Veritable Name|Description|Seer Codes (2018-2022)|Recoding for modeling|
|:------|:------ |:------------|:------------|
|Radiation recode|Radiation of the primary site|Beam radiation<BR> Radioactive implants (includes brachytherapy) (1988+)<BR>Refused (1988+)<BR>Combination of beam with implants or isotopes<BR>None/Unknown|Binary: <BR>1 = any radiation [Beam radiation Radioactive implants (includes brachytherapy) (1988+), Refused (1988+),<BR>Combination of beam with implants or isotopes]<BR>0 = no radiation or unknown [None/Unknown]|
|Chemotherapy recode|The chemotherapy given as a part of the first course of treatment or the reason that chemotherapy was not given.|Yes = patient had chemotherapy<BR>No/Unknown = no evidence of chemotherapy was found in the medical records examined|Binary: <BR>1 = any chemotherapy[Yes]<BR>0 = no chemotherapy [No/Unknown]|
|Sequence number|Describes the number and sequence of all reportable malignant, in situ, benign, and borderline primary tumors that occur over the lifetime of a patient.|One primary only <BR>1st of 2 or more primaries <BR>2nd of 2 or more primaries etc.|Filter data to only include “One primary only” and “1st of 2 or more primaries”|



Table 2

***Treatment Characteristics***

|Veritable Name|Description|Seer Codes (2018-2022)|Recoding for modeling|
|:------|:------ |:------------|:------------|
|Tumor Size Summary (2016+)|Size of a solid primary tumor before any treatment|000 = No mass/tumor found<BR>001 = 1 mm or described as less than 1 mm (0.1 cm or less than 0.1 cm)<BR>002-988 = Exact size in millimeters (2 mm to 988 mm) (0.2 to 98.8 cm)<BR>989 = 989 millimeters or larger (98.9 cm or larger)<BR>990 = Microscopic focus or foci only and no size of focus is given<BR>998 = Alternate descriptions of tumor size for specific sites: Diffuse Breast (C50.0-C50.6, C50.8-C50.9)<BR>999 = Unknown; size not stated, Not documented in patient record, Size of tumor cannot be assessed, The only measurement(s) describes pieces or chips, Not applicable|Continuous numeric|
|Combined Summary Stage with Expanded Regional Codes (2004+)|Cancer staging system that categorizes the extent of cancer spread from its point of origin using a combination of clinical and pathological data.|In situ<BR>Localized only<BR>Regional by direct extension only <BR>Regional lymph nodes involved only<BR>Regional by both direct extension and lymph node involvement<BR>Distant site(s)/node(s) involved <BR>Unknown/unstaged/unspecified/DCO|Categorical: <BR>In situ<BR>Localized only<BR>Regional by direct extension only<BR>Regional lymph nodes involved only<BR>Regional by both direct extension and lymph node involvement<BR>Distant site(s)/node(s) involved<BR>Unknown/unstaged/unspecified/DCO|
|EOD Regional Nodes Recode (2018+)|Records the farthest regional lymph node chain involved by a tumor|000 = No clinical regional lymph node involvement<BR>030 = PATHOLOGICAL, ITCs only (malignant cell clusters no larger than 0.2 mm) in regional lymph node(s)<BR>050 = PATHOLOGICAL, Positive molecular findings by reverse transcriptase polymerase chain reaction (RT-PCR), no ITCs detected<BR>070 = No regional lymph node involvement pathologically (lymph nodes removed and pathologically negative) WITHOUT ITCs or ITC testing unknown<BR>100 = Micrometastasis, less than or equal to 2 mm, Axillary (level I and II) lymph node(s), ipsilateral, Detected by IHC or H&E (At least one micrometastasis greater than 0.2 mm or more than 200 cells), Micrometastasis, NOS<BR>150 = CLINICAL, Clinically positive movable axillary (level I and II) lymph node(s), ipsilateral, Positive needle core biopsy/FNA<BR>200 = PATHOLOGICAL, Positive axillary (level I and II) lymph node(s), ipsilateral, WITH more than micrometastasis (At least one metastasis greater than 2 mm, or size of metastasis not stated), WITHOUT internal mammary lymph node(s) or not stated<BR>250 = PATHOLOGICAL, Internal mammary node(s), ipsilateral, positive on sentinel node biopsy but not clinically apparent (No positive imaging or clinical exam) WITHOUT axillary lymph node(s), ipsilateral<BR>300 = PATHOLOGICAL, Internal mammary node(s), ipsilateral, positive on sentinel node biopsy but not clinically apparent (No positive imaging or clinical exam) WITH axillary lymph node(s), ipsilateral<BR>350 = CLINICAL, Fixed/matted ipsilateral axillary (level I and II)<BR>400 = CLINICAL, Internal mammary node(s), ipsilateral WITHOUT axillary (level I and II) lymph node(s), ipsilateral RN<BR>500 = Infraclavicular lymph node(s) (subclavicular) (level III axillary node(s)) (apical), ipsilateral WITH or WITHOUT axillary (level I and II) nodes(s) WITHOUT internal mammary node<BR>600 = Internal mammary node(s), ipsilateral, clinically apparent (On imaging or clinical exam) WITH axillary (level I, II, or III) lymph node(s), ipsilateral including infraclavicular<BR>700 = Supraclavicular node(s), ipsilateral<BR>800 = Regional lymph node(s), NOS, Lymph node(s), NOS<BR>999 = Unknown; regional lymph node(s) not stated, Regional lymph node(s) cannot be assessed, Not documented in patient record, Death Certificate Only|Categorical:<BR>N0 = 000, 030, 050, 070<BR>N1 = 100, 150, 200, 250, 300<BR>N2 = 350, 400<BR>N3 = 500, 600, 700<BR>NX = 800, 999|
|SEER Combined Mets at DX-bone (2010+)|This field identifies whether bone is an involved metastatic site.|No = no bone metastases<BR>Yes = yes distant bone metastases<BR>N/A Unknown|Binary: <BR>No = no bone metastases<BR>Yes = yes distant bone metastases<BR>*exclude N/A and Unknown|
|SEER Combined Mets at DX-brain (2010+)|This field identifies whether brain is an involved metastatic site.|No = no brain metastases<BR>Yes = yes distant brain metastases<BR>N/A Unknown|Binary: <BR>No = no brain metastases<BR>Yes = yes distant brain metastases<BR>*exclude N/A and Unknown|
|SEER Combined Mets at DX-liver (2010+)|This field identifies whether liver is an involved metastatic site.|No = no liver metastases<BR>Yes = yes distant liver metastases<BR>N/A Unknown|Binary: <BR>No = no liver metastases<BR>Yes = yes distant liver metastases<BR>*exclude N/A and Unknown|
|SEER Combined Mets at DX-lung (2010+)|This field identifies whether lung is an involved metastatic site.|No = no lung metastases<BR>Yes = yes distant lung metastases<BR>N/A Unknown|Binary: <BR>No = no lung metastases<BR>Yes = yes distant lung metastases<BR>*exclude N/A and Unknown|
|Mets at DX-Distant LN|This field identifies whether distant lymph node(s) are an involved metastatic site.|No = no distant lymph node metastases<BR>Yes = yes distant lymph node metastases<BR>N/A Unknown|Binary: <BR>No = no distant lymph node metastases<BR>Yes = yes distant lymph node metastases<BR>*exclude N/A and Unknown|
|Laterality|Describes the side of a paired organ or side of the body on which the reportable tumor originated.|Right - origin of primary <BR>Left - origin of primary<BR>Only one side - side unspecified<BR>Bilateral, single primary <BR>Paired site, but no information concerning laterality|Categorical:<BR>Right - origin of primary<BR>Left - origin of primary<BR>Bilateral, single primary <BR>*exclude “Only one side - side unspecified Bilateral, single primary” and “Paired site, but no information concerning laterality”|
|Grade Clinical (2018+)|Records the grade of a solid primary tumor before any treatment|1 = G1: Low combined histologic grade (favorable), SBR score of 3–5 points<BR>2 = G2: Intermediate combined histologic grade (moderately favorable); SBR score of 6–7 points<BR>3 = G3: High combined histologic grade (unfavorable); SBR score of 8–9 points<BR>L = Nuclear Grade I (Low) (in situ only)<BR>M = Nuclear Grade II (interMediate) (in situ only)<BR>H = Nuclear Grade III (High) (in situ only)<BR>A = Well differentiated<BR>B = Moderately differentiated<BR> C = Poorly differentiated<BR>D = Undifferentiated, anaplastic<BR>8 = Not applicable (Hematopoietic neoplasms only)<BR>9 = Grade cannot be assessed (GX); Unknown|Categorical: <BR>Low = 1, A, L<BR>Intermediate = 2, B, M<BR>High = 3, C, H, D<BR>*exclude N/A (8) and unknown (9)|
|ER Status Recode Breast Cancer (1990+)|Results of the estrogen receptor (ER) assay|Negative<BR>Positive<BR>Borderline/Unknown<BR>Recode not available|Binary: <BR>Negative<BR>Positive<BR>*exclude Borderline/Unknown, Recode not available|
|PR Status Recode Breast Cancer (1990+)|Results from the progesterone receptor (PR) assay|Negative<BR>Positive<BR>Borderline/Unknown<BR>Recode not available|Binary: <BR>Negative<BR>Positive<BR>*exclude Borderline/Unknown, Recode not available|
|HER2 Overall Summary Recode (2018+)|Summary of results from HER2 testing|HER2 negative; equivocal<BR>HER2 positive<BR>Test ordered, results not in chart<BR>Not documented; Cannot be determined; Not assessed or unknown if assessed|Binary: <BR>HER2 negative; equivocal<BR>HER2 positive<BR>*exclude Test ordered, results not in chart, Not documented; Cannot be determined; Not assessed or unknown if assessed|

Table 3

***Patient Demographics***

|Veritable Name|Description|Seer Codes (2018-2022)|Recoding for modeling|
|:------|:------ |:------------|:------------|
|Age recode with <1 year olds|This data item represents the age of the patient at diagnosis for this cancer.|00 years <BR>01-04 years<BR>05-09 years<BR>10-14 years<BR>15-19 years<BR>20-24 years<BR>25-29 years <BR>30-34 years<BR>35-39 years<BR>40-44 years<BR>45-49 years <BR>50-54 years<BR>55-59 years<BR>60-64 years<BR>65-69 years<BR>70-74 years<BR>75-79 years<BR>80-84 years<BR>85+ years|Categorical: <BR>00 years <BR>01-04 years<BR>05-09 years<BR>10-14 years<BR>15-19 years<BR>20-24 years<BR>25-29 years <BR>30-34 years<BR>35-39 years<BR>40-44 years<BR>45-49 years <BR>50-54 years<BR>55-59 years<BR>60-64 years<BR>65-69 years<BR>70-74 years<BR>75-79 years<BR>80-84 years<BR>85+ years|"
|Sex|Male or Female|Male<BR>Female|Binary: <BR>Male <BR>Female|
|Race recode (W, B, AI, API)|Groups race into the following categories: White (W), Black (B), American Indian/Alaska Native (AI), and Asian/Pacific Islander (API)|White<BR>Black <BR>American Indian/Alaska Native<BR>Asian/Pacific Islander <BR>Unknown|Categorical: <BR>White<BR>Black <BR>American Indian/Alaska Native<BR>Asian/Pacific Islander <BR>Unknown|
|Origin recode NHIA (Hispanic, Non-Hisp)|Classifies cancer registry patients into one of two categories: Hispanic or Non-Hispanic, using the NAACCR Hispanic Identification Algorithm (NHIA)|Non-Spanish-Hispanic-Latino<BR>Spanish-Hispanic-Latino|Categorical: <BR>Non-Spanish-Hispanic-Latino<BR>Spanish-Hispanic-Latino|
|Race and origin recode (NHW, NHB, NHAIAN, NHAPI, Hispanic)|Combines race and Hispanic ethnicity for analysis, creating a single variable for Non-Hispanic White (NHW), Non-Hispanic Black (NHB), Non-Hispanic American Indian/Alaska Native (NHAIAN), Non-Hispanic Asian/Pacific Islander (NHAPI), and Hispanic (of any race) categories|Hispanic (All Races)<BR>Non-Hispanic White<BR>Non-Hispanic Black<BR>Non-Hispanic American Indian/Alaska Native<BR>Non-Hispanic Asian or Pacific Islander<BR>Non-Hispanic Unknown Race|Categorical: <BR>Non-Spanish-Hispanic-Latino<BR>Spanish-Hispanic-Latino|
|Marital status at diagnosis|Patient’s marital status at the time of diagnosis for the reportable tumor|Single (never married) <BR>Married (including common law)<BR>Separated<BR>Divorced<BR>Widowed<BR>Unmarried or Domestic Partner <BR>Unknown|Binary:<BR>Partnered = Married (including common law), Unmarried or Domestic Partner <BR>Unpartnered = Single (never married), Separated, Divorced, Widowed<BR>*exclude Unknown|
|Type of Reporting Source|Identifies the source documents that provided the most complete information when abstracting the case|Hospital inpatient/outpatient or clinic<BR>Radiation treatment or medical oncology center (2006+)<BR>Laboratory only (hospital or private)<BR>Physicians office/private medical practitioner (LMD)<BR>Nursing/convalescent home/hospice<BR>Autopsy Only<BR>Death Certificate Only<BR>Other hospital outpatient unit or surgery center (2006+)|Categorical: <BR>Hospital inpatient/outpatient or clinic<BR>Radiation treatment or medical oncology center (2006+)<BR>Laboratory only (hospital or private)<BR>Physicians office/private medical practitioner (LMD)<BR>Nursing/convalescent home/hospice<BR>Autopsy Only<BR>Death Certificate Only<BR>Other hospital outpatient unit or surgery center (2006+)|
|Year of Diagnosis|Cancers diagnosed from 2018-2022|2018<BR>2019<BR>2021<BR>2022|Categorical: <BR>2018<BR>2019<BR>2021<BR>2022|


Only female breast cancer cases (C50.0–C50.9) diagnosed from 2018–2021 were included.
First primary malignancies only (Sequence Number = 00 or 01).
Cases with missing or unknown treatment or key staging variables were excluded.
Variables were recoded into consistent binary or continuous formats suitable for Lasso logistic regression modeling.


## Methods

The basis for LASSO and Ridge regression is Ordinary Least Squares (OLS) regression. The objective of OLS regression is to minimize the sum of the squared residuals, which are the differences between the observed and predicted outcome values. The equation for OLS regression can be expressed as:

\begin{equation*} \hat{\beta}_{ols}=\underset{\beta}{\arg\min}\left\{\sum_{i=1}^{N}\left(y_{i}-\beta_{0}-\sum_{j=1}^{p}x_{ij}\beta_{j}\right)^{2}\right\} \tag{1} \end{equation*}

Where *N* is our number of observations, *p* is our number of parameters, *y~i~* is an observed outcome variable value, 𝛽~0~ is the intercept, *𝑥~ij~* is an observed predictor variable value, and 𝛽~𝑗~ is the coefficient for a parameter (Muthukrishnan and Rohini, 2016).

However, while OLS regression has low bias, it is also prone to overfitting and thus high variance. LASSO and Ridge regression remedy this by introducing a shrinkage parameter, denoted as 𝜆. By shrinking the parameters, we introduce some bias but at the benefit of much lower variance.

For LASSO and Ridge regression, respectively, the basic OLS regression equation is modified to:

\begin{equation*} \hat{\beta}^{lasso}=\underset{\beta}{\arg\min}\left\{\frac{1}{2}\sum_{i=1}^{N}\left(y_{i}-\beta_{0}-\sum_{j=1}^{p}x_{ij}\beta_{j}\right)^{2}+\lambda\sum_{j=1}^{p}\left\vert\beta_{j}\right\vert\right\} \tag{2} \end{equation*}


\begin{equation*} \hat{\beta}^{ridge}=\underset{\beta}{\arg\min}\left\{\sum_{i=1}^{N}\left(y_{i}-\beta_{0}-\sum_{j=1}^{p}x_{ij}\beta_{j}\right)^{2}+\lambda\sum_{j=1}^{p}\beta_{j}^{2}\right\} \tag{3}\end{equation*}


where 𝜆 is the shrinkage parameter[@muthu]. Clearly, the higher the value of 𝜆, the more the parameters are shrunken towards zero. Simply put, Ridge regression minimizes a combination of the sum of squared residuals and the shrinkage parameter times the squared sum of the parameters (L2-regularization), while LASSO regression minimizes a combination of the sum of squared residuals and the shrinkage parameter times the sum of the absolute values of the parameters (L1-regularization).

Of note, there exists an adaptation of the lasso regression created by Zou in 2006 called the “adaptive lasso”. The “adaptive lasso” penalized each parameter according to the importance, or weight, of its corresponding predictor variable. The adaptive lasso can be written as:

\begin{equation*} \hat{\beta}^{adaptive  lasso}=\underset{\beta}{\arg\min}\left\{\frac{1}{2}\sum_{i=1}^{N}\left(y_{i}-\beta_{0}-\sum_{j=1}^{p}x_{ij}\beta_{j}\right)^{2}+\lambda\sum_{j=1}^{p} w_{j}\left\vert\beta_{j}\right\vert\right\}\tag{4}\end{equation*}

where 𝑤~𝑗~ is the weight assigned to a certain parameter[@vidaurre].

## Analysis and Results





## Modeling and Results


## Conclusion


## References

